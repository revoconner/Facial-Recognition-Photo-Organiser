<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Recognition</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="title-bar">
        <div class="title-bar-drag pywebview-drag-region">
            <div class="title-bar-title">Face Recognition Photo Organizer</div>
        </div>
        <div class="title-bar-controls">
            <button class="title-bar-btn minimize-btn" id="minimizeBtn" title="Minimize">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <rect x="0" y="5" width="12" height="2" fill="currentColor"/>
                </svg>
            </button>
            <button class="title-bar-btn maximize-btn" id="maximizeBtn" title="Maximize">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <rect x="1" y="1" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.5"/>
                </svg>
            </button>
            <button class="title-bar-btn close-btn" id="closeBtn" title="Close">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <path d="M1 1 L11 11 M11 1 L1 11" stroke="currentColor" stroke-width="1.5"/>
                </svg>
            </button>
        </div>
    </div>
    <div class="app-container" id="appContainer">
        <div class="main-content">
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title-row">
                        <div class="sidebar-title">People</div>
                        <div class="sidebar-controls">
                            <button class="icon-btn" id="filterBtn" title="Filter">
                                <div class="doner-icon">
                                    <div class="doner-line"></div>
                                    <div class="doner-line"></div>
                                    <div class="doner-line"></div>
                                </div>
                            </button>
                            <button class="icon-btn" id="jumpToBtn" title="Jump to">
                                <div class="bento-icon">
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                    <div class="bento-dot"></div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="people-list" id="peopleList"></div>
            </div>

            <div class="content-area">
                <div class="content-header">
                    <div class="content-title" id="contentTitle">Select a person</div>
                    <div class="content-controls">
                        <div class="size-control">
                            <span class="size-label">Size:</span>
                            <input type="range" class="size-slider" id="sizeSlider" min="100" max="300" value="180">
                        </div>
                        <select class="view-dropdown">
                            <option>Show entire photo</option>
                            <option>Zoom to tagged faces</option>
                        </select>
                    </div>
                </div>
                <div class="photo-grid-container">
                    <div class="photo-grid" id="photoGrid"></div>
                </div>
            </div>
        </div>

        <div class="bottom-bar">
            <div class="bottom-content">
                <button class="settings-btn" id="openSettingsBtn">Settings</button>
                <div class="progress-section" id="progressSection">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Initializing...</div>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-info" id="statusInfo">
                    <span class="status-badge">
                        <span class="status-indicator"></span>
                        <span id="pytorchVersion">PyTorch</span>
                    </span>
                    <span id="gpuStatus">Checking...</span>
                    <span id="cudaVersion">CUDA: N/A</span>
                    <span id="faceCount">Found: 0 faces</span>
                </div>
            </div>
        </div>
    </div>

    <div class="settings-overlay" id="settingsOverlay">
        <div class="settings-container" id="settingsContainer">
            <div class="settings-sidebar">
                <div class="settings-header">
                    <div class="settings-title">Settings</div>
                </div>
                
                <div class="settings-nav">
                    <div class="nav-item active" data-panel="general">General Settings</div>
                    <div class="nav-item" data-panel="folders">Folders to Scan</div>
                    <div class="nav-item" data-panel="log">View Log</div>
                </div>
                
                <div class="settings-footer">
                    <button class="close-settings-btn" id="closeSettingsBtn">Close Settings</button>
                    <div class="footer-credit">Made by RO</div>
                </div>
            </div>
            
            <div class="settings-content">
                <div class="content-panel active" id="general-panel">
                    <div class="panel-title">General Settings</div>
                    
                    <div class="setting-group">
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Threshold</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">Change threshold values for the AI to detect faces, higher values = stricter match, so similar looking faces will be scrutinized better, but it also may end up creating more persons for different lighting conditions. Default 50%</div>
                                </span>
                            </div>
                            <div class="threshold-control">
                                <div class="threshold-slider-wrapper">
                                    <input type="range" class="threshold-slider" id="thresholdSlider" 
                                           min="10" max="90" value="50">
                                    <span class="threshold-value" id="thresholdValue">50%</span>
                                </div>
                                <button class="recalibrate-btn" id="recalibrateBtn">Recalibrate</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Use system resources dynamically</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">Smartly uses system resources to not hinder user's task. When enabled, limits CPU usage to 5% when app runs in background. When disabled, the app will perform faster at the cost of fully utilizing system's resources. Default On.</div>
                                </span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="dynamicResourcesToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Show single unmatched images</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">Faces that have no matches with any other image are hidden by default, as they are likely images users do not care about. Show them grouped under UNMATCHED FACES. Default Off</div>
                                </span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showUnmatchedToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Close to tray</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">Keeps the program running in system's tray when closed, to quit right click the tray icon and select quit. Default On</div>
                                </span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="closeToTrayToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Show hidden person</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">People hidden from the list by the user will shown in the list again as long as this is turned on. You can unhide individual names from the list once visible. Default Off</div>
                                </span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showHiddenToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-row">
                            <div class="setting-label">
                                <span>Show development options</span>
                                <span class="info-icon">
                                    i
                                    <div class="tooltip">Shows internal tagging statistics and advanced options for debugging. Regular users should keep this off. Default Off</div>
                                </span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showDevOptionsToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="content-panel" id="folders-panel">
                    <div class="panel-title">Folders to Scan</div>
                    
                    <div class="folder-section">
                        <div class="folder-section-title">
                            <span>Include folders for scanning</span>
                            <span class="info-icon">
                                i
                                <div class="tooltip">Include all folders that will be scanned for photos. Default is the user's photos library on Windows.</div>
                            </span>
                        </div>
                        <div class="folder-list-container" id="includeFolders">
                            <div style="color: #606060; padding: 12px; text-align: center; font-size: 13px;">No folders added yet</div>
                        </div>
                        <div class="folder-controls">
                            <button class="folder-btn" id="addIncludeBtn">
                                <span>+</span>
                                <span>Add Folder</span>
                            </button>
                            <button class="folder-btn remove" id="removeIncludeBtn">
                                <span>-</span>
                                <span>Remove Folder</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="folder-section">
                        <div class="folder-section-title">
                            <span>Exclude subfolders from scanning</span>
                            <span class="info-icon">
                                i
                                <div class="tooltip">Exclude subfolders of "included folders" above, that are not to be scanned. This takes precedence over include folders.</div>
                            </span>
                        </div>
                        <div class="folder-list-container" id="excludeFolders">
                            <div style="color: #606060; padding: 12px; text-align: center; font-size: 13px;">No folders excluded yet</div>
                        </div>
                        <div class="folder-controls">
                            <button class="folder-btn" id="addExcludeBtn">
                                <span>+</span>
                                <span>Add Folder</span>
                            </button>
                            <button class="folder-btn remove" id="removeExcludeBtn">
                                <span>-</span>
                                <span>Remove Folder</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="folder-section">
                        <div class="folder-section-title">
                            <span>Wildcard Exclusion</span>
                            <span class="info-icon">
                                i
                                <div class="tooltip">Use wildcards like *.jpg, *.gif with extension names or *thumbnail with folder names to exclude them from being scanned, separated by commas</div>
                            </span>
                        </div>
                        <input type="text" class="wildcard-input" id="wildcardInput" placeholder="e.g., *.gif, *thumbnail, *cache*, C:\Photos\private photos ">
                    </div>
                    
                    <div class="folder-section">
                        <button class="recalibrate-btn" id="rescanBtn" style="width: 100%; padding: 12px;">Rescan For Changes</button>
                    </div>
                </div>
                
                <div class="content-panel" id="log-panel">
                    <div class="log-header">
                        <div class="panel-title">View Log</div>
                        <button class="save-log-btn" id="saveLogBtn">
                            <span>Save Log</span>
                        </button>
                    </div>
                    
                    <div class="log-viewer" id="logViewer">
                        <div class="log-entry">Application started</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="cleanup-overlay" id="cleanupOverlay">
        <div class="cleanup-message">
            <div class="cleanup-title">Cleaning up and quitting</div>
        </div>
    </div>

    <script src="ui_js_script.js"></script>
</body>
</html>
